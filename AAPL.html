<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="description" content="Transparent Metrics — prototype metrics layout for Apple Inc. (AAPL).">
  <meta name="keywords" content="Apple, AAPL, stock metrics, financial ratios, valuation, Transparent Metrics">
  <meta name="author" content="Ferdi">
  <title>Apple (AAPL) · Transparent Metrics</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    :root {
      --bg: #050814;
      --bg-elevated: #0b1020;
      --bg-soft: #111827;
      --accent: #38bdf8;
      --accent-soft: rgba(56, 189, 248, 0.12);
      --text-main: #e5e7eb;
      --text-muted: #9ca3af;
      --border-subtle: rgba(148, 163, 184, 0.35);
      --danger: #f97373;
    }

    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    body {
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      background: radial-gradient(circle at top, #020617 0, #020617 30%, #020617 60%, #000000 100%);
      color: var(--text-main);
      line-height: 1.5;
    }

    a {
      color: inherit;
      text-decoration: none;
    }

    .page {
      min-height: 100vh;
      display: flex;
      flex-direction: column;
    }

    .container {
      width: 100%;
      max-width: 1120px;
      margin: 0 auto;
      padding: 1.5rem 1.25rem 3rem;
    }

    /* Header */

    header {
      border-bottom: 1px solid rgba(148, 163, 184, 0.18);
      backdrop-filter: blur(16px);
      background: radial-gradient(circle at top left, rgba(56, 189, 248, 0.08), transparent 60%);
      position: sticky;
      top: 0;
      z-index: 10;
    }

    .header-inner {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 1rem;
      padding: 0.85rem 1.25rem;
      max-width: 1120px;
      margin: 0 auto;
    }

    .logo {
      display: flex;
      align-items: center;
      gap: 0.6rem;
      font-weight: 600;
      letter-spacing: 0.06em;
      text-transform: uppercase;
      font-size: 0.9rem;
    }

    .logo-icon {
      width: 26px;
      height: 26px;
      border-radius: 999px;
      border: 1px solid rgba(56, 189, 248, 0.5);
      background: radial-gradient(circle at 30% 20%, #38bdf8, #0f172a);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 0.75rem;
      color: #0b1120;
      box-shadow: 0 0 24px rgba(56, 189, 248, 0.5);
    }

    nav {
      display: flex;
      align-items: center;
      gap: 1.25rem;
      font-size: 0.9rem;
      color: var(--text-muted);
    }

    nav a {
      position: relative;
      padding-bottom: 0.1rem;
    }

    nav a::after {
      content: "";
      position: absolute;
      left: 0;
      bottom: -0.15rem;
      width: 0;
      height: 1px;
      background: var(--accent);
      transition: width 0.18s ease;
    }

    nav a:hover {
      color: var(--text-main);
    }

    nav a:hover::after {
      width: 100%;
    }

    /* Hero */

    main {
      flex: 1;
    }

    .hero {
      padding-top: 2.5rem;
      padding-bottom: 2.75rem;
    }

    .hero-grid {
      display: grid;
      grid-template-columns: minmax(0, 1.6fr) minmax(0, 1.4fr);
      gap: 2.5rem;
      align-items: center;
    }

    @media (max-width: 840px) {
      .hero-grid {
        grid-template-columns: minmax(0, 1fr);
      }
    }

    .pill {
      display: inline-flex;
      align-items: center;
      gap: 0.4rem;
      padding: 0.15rem 0.7rem;
      border-radius: 999px;
      border: 1px solid rgba(56, 189, 248, 0.45);
      background: radial-gradient(circle at top left, rgba(56, 189, 248, 0.16), transparent 70%);
      font-size: 0.75rem;
      color: var(--text-muted);
      margin-bottom: 0.85rem;
    }

    .pill-dot {
      width: 7px;
      height: 7px;
      border-radius: 999px;
      background: #4ade80;
      box-shadow: 0 0 12px rgba(74, 222, 128, 0.8);
    }

    .hero-title {
      font-size: clamp(2rem, 3.1vw, 2.6rem);
      font-weight: 650;
      letter-spacing: 0.02em;
      margin-bottom: 0.35rem;
    }

    .hero-ticker {
      font-size: 0.9rem;
      text-transform: uppercase;
      letter-spacing: 0.14em;
      color: var(--accent);
      margin-bottom: 0.85rem;
    }

    .hero-subtitle {
      font-size: 1rem;
      color: var(--text-muted);
      max-width: 32rem;
      margin-bottom: 1rem;
    }

    .hero-note {
      font-size: 0.8rem;
      color: var(--text-muted);
      opacity: 0.9;
    }

    /* Search card (hero right) */

    .search-card {
      border-radius: 1.25rem;
      background: radial-gradient(circle at top right, rgba(56, 189, 248, 0.2), transparent 60%), var(--bg-elevated);
      border: 1px solid rgba(148, 163, 184, 0.28);
      padding: 1.4rem 1.35rem;
      box-shadow: 0 22px 45px rgba(15, 23, 42, 0.8);
      font-size: 0.88rem;
      color: var(--text-muted);
    }

    .search-label {
      font-size: 0.8rem;
      text-transform: uppercase;
      letter-spacing: 0.14em;
      color: var(--text-muted);
      margin-bottom: 0.5rem;
    }

    .current-ticker-label {
      font-size: 0.78rem;
      color: var(--accent);
      margin-bottom: 0.4rem;
    }

    .search-row {
      display: flex;
      gap: 0.6rem;
      margin-bottom: 0.6rem;
    }

    .search-input-wrapper {
      position: relative;
      flex: 1;
    }

    .search-input {
      flex: 1;
      width: 100%;
      padding: 0.55rem 0.8rem;
      border-radius: 999px;
      border: 1px solid rgba(148, 163, 184, 0.45);
      background: rgba(15, 23, 42, 0.85);
      color: var(--text-main);
      font-size: 0.9rem;
      outline: none;
    }

    .search-input::placeholder {
      color: rgba(148, 163, 184, 0.85);
    }

    .search-btn {
      padding: 0.55rem 1.0rem;
      border-radius: 999px;
      border: none;
      font-size: 0.9rem;
      font-weight: 500;
      letter-spacing: 0.02em;
      text-transform: uppercase;
      cursor: pointer;
      background: var(--accent);
      color: #020617;
    }

    .tag-row {
      display: flex;
      flex-wrap: wrap;
      gap: 0.35rem;
      margin-top: 0.4rem;
      margin-bottom: 0.4rem;
    }

    .tag {
      font-size: 0.78rem;
      border-radius: 999px;
      padding: 0.15rem 0.6rem;
      border: 1px solid rgba(148, 163, 184, 0.55);
      color: var(--text-muted);
      background: rgba(15, 23, 42, 0.9);
      cursor: pointer;
    }

    .tag--current {
      border-color: rgba(56, 189, 248, 0.85);
      color: #0f172a;
      background: var(--accent);
      cursor: default;
    }

    .search-callout {
      font-size: 0.8rem;
      color: var(--text-muted);
      border-radius: 0.8rem;
      border: 1px dashed rgba(148, 163, 184, 0.5);
      padding: 0.6rem 0.7rem;
      background: rgba(15, 23, 42, 0.7);
      margin-top: 0.75rem;
    }

    /* Autocomplete dropdown */

    .suggestion-box {
      position: absolute;
      top: 100%;
      left: 0;
      right: 0;
      margin-top: 0.25rem;
      background: rgba(15, 23, 42, 0.98);
      border: 1px solid rgba(148, 163, 184, 0.35);
      border-radius: 0.75rem;
      padding: 0.35rem 0.4rem;
      backdrop-filter: blur(8px);
      max-height: 180px;
      overflow-y: auto;
      box-shadow: 0 12px 24px rgba(0,0,0,0.35);
      font-size: 0.82rem;
      z-index: 20;
    }

    .suggestion-box ul {
      list-style: none;
      padding: 0;
      margin: 0;
    }

    .suggestion-box li {
      display: flex;
      align-items: baseline;
      gap: 0.3rem;
      padding: 0.3rem 0.35rem;
      border-radius: 0.4rem;
      cursor: pointer;
      transition: background 0.15s;
    }

    .suggestion-box li:hover {
      background: rgba(56, 189, 248, 0.15);
    }

    .suggestion-ticker {
      font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
      font-weight: 600;
      letter-spacing: 0.06em;
    }

    .suggestion-name {
      color: var(--text-muted);
      font-size: 0.78rem;
    }

    .suggestion-link {
      display: flex;
      gap: 0.3rem;
      width: 100%;
      color: inherit;
      text-decoration: none;
    }

    .suggestion-link:hover {
      background: rgba(56, 189, 248, 0.15);
      border-radius: 0.4rem;
    }

    /* Sections */

    .section {
      padding: 1.75rem 0 0.5rem;
    }

    .section-header {
      display: flex;
      justify-content: space-between;
      align-items: baseline;
      margin-bottom: 1.1rem;
      gap: 0.5rem;
    }

    .section-title {
      font-size: 1.0rem;
      text-transform: uppercase;
      letter-spacing: 0.16em;
      color: var(--text-muted);
    }

    .section-subtitle {
      font-size: 0.85rem;
      color: var(--text-muted);
    }

    /* Metric layout */

    .metric-layout {
      display: grid;
      grid-template-columns: minmax(0, 1.6fr) minmax(0, 1.1fr);
      gap: 1.5rem;
      align-items: flex-start;
    }

    @media (max-width: 900px) {
      .metric-layout {
        grid-template-columns: minmax(0, 1fr);
      }
    }

    .metric-groups {
      display: flex;
      flex-direction: column;
      gap: 1rem;
    }

    .metric-group-card {
      border-radius: 1.1rem;
      padding: 0.9rem 1rem;
      background: var(--bg-elevated);
      border: 1px solid var(--border-subtle);
    }

    .metric-group-title {
      font-size: 0.9rem;
      font-weight: 550;
      margin-bottom: 0.4rem;
    }

    .metric-group-subtitle {
      font-size: 0.78rem;
      color: var(--text-muted);
      margin-bottom: 0.5rem;
    }

    .metric-table {
      width: 100%;
      border-collapse: collapse;
      font-size: 0.82rem;
    }

    .metric-table th,
    .metric-table td {
      padding: 0.35rem 0.2rem;
      text-align: left;
      border-bottom: 1px solid rgba(15, 23, 42, 0.9);
    }

    .metric-table th {
      color: var(--text-muted);
      font-weight: 500;
      font-size: 0.74rem;
      text-transform: uppercase;
      letter-spacing: 0.08em;
    }

    .metric-table tr:last-child td {
      border-bottom: none;
    }

    .metric-name-btn {
  display: block;
  width: 100%;
  text-align: left;
  padding: 0.45rem 0.6rem;
  border-radius: 0.45rem;
  cursor: pointer;
  background: transparent;
  border: none;
  color: var(--text-main);
  font-size: 0.85rem;
  transition: background 0.15s, color 0.15s;
}

.metric-name-btn:hover {
  background: rgba(56, 189, 248, 0.12);
}

/* Highlight the entire row when active */
.metric-name-btn.active {
  background: rgba(56, 189, 248, 0.20);
  color: var(--accent);
  font-weight: 600;

    }

    .metric-name-btn span.dot {
      width: 6px;
      height: 6px;
      border-radius: 999px;
      background: var(--accent);
      opacity: 0;
      transition: opacity 0.15s ease;
    }

    .metric-name-btn:hover span.dot,
    .metric-name-btn.active span.dot {
      opacity: 1;
    }

    .metric-name-btn:hover {
      color: var(--accent);
    }

    .metric-value {
      color: var(--text-muted);
      font-size: 0.8rem;
    }

    .metric-value-pill {
      display: inline-flex;
      align-items: center;
      padding: 0.12rem 0.45rem;
      border-radius: 999px;
      border: 1px solid rgba(148, 163, 184, 0.4);
      font-size: 0.75rem;
      color: var(--text-muted);
    }

    /* Detail card */

    .metric-detail-card {
      border-radius: 1.1rem;
      padding: 1rem 1rem;
      background: var(--bg-soft);
      border: 1px solid var(--border-subtle);
      position: sticky;
      top: 6rem;
    }

    @media (max-width: 900px) {
      .metric-detail-card {
        position: static;
      }
    }

    .metric-detail-label {
      font-size: 0.75rem;
      text-transform: uppercase;
      letter-spacing: 0.13em;
      color: var(--text-muted);
      margin-bottom: 0.35rem;
    }

    .metric-detail-category {
      font-size: 0.82rem;
      color: var(--accent);
      margin-bottom: 0.2rem;
    }

    .metric-detail-name {
      font-size: 1rem;
      font-weight: 560;
      margin-bottom: 0.5rem;
    }

    .metric-detail-body {
      font-size: 0.86rem;
      color: var(--text-muted);
      margin-bottom: 0.75rem;
    }

    .metric-detail-hint {
      font-size: 0.76rem;
      color: rgba(148, 163, 184, 0.9);
      border-top: 1px dashed rgba(148, 163, 184, 0.4);
      padding-top: 0.6rem;
    }
    .metric-detail-value-row {
  display: flex;
  justify-content: space-between;
  align-items: baseline;
  margin-bottom: 0.6rem;
}

.metric-detail-value {
  font-size: 0.95rem;
  font-weight: 600;
  color: var(--text-main);
}

.metric-detail-box {
  margin-bottom: 0.6rem;
}

.metric-detail-formula,
.metric-detail-inputs {
  font-size: 0.8rem;
  color: var(--text-muted);
  margin-top: 0.15rem;
  line-height: 1.4;
}

    /* Footer */

    footer {
      border-top: 1px solid rgba(15, 23, 42, 0.9);
      margin-top: 2.4rem;
      padding: 0.9rem 0;
      background: #020617;
    }

    .footer-inner {
      max-width: 1120px;
      margin: 0 auto;
      padding: 0 1.25rem;
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 0.75rem;
      font-size: 0.78rem;
      color: var(--text-muted);
    }

    .footer-links {
      display: flex;
      gap: 1rem;
      flex-wrap: wrap;
    }

    .footer-links a {
      text-decoration: underline;
      text-decoration-style: dotted;
      text-underline-offset: 3px;
    }

    @media (max-width: 640px) {
      .footer-inner {
        flex-direction: column;
        align-items: flex-start;
      }
    }
  </style>
</head>
<body>
  <div class="page">
    <!-- HEADER -->
    <header>
      <div class="header-inner">
        <div class="logo">
          <div class="logo-icon">TM</div>
          <span>Transparent Metrics</span>
        </div>
        <nav>
          <a href="./">Home</a>
          <a href="./#how-it-works">How it works</a>
          <a href="./#example">Example</a>
          <a href="./#about">About</a>
        </nav>
      </div>
    </header>

    <!-- MAIN -->
    <main id="top">
      <div class="container">
        <!-- HERO -->
        <section class="hero">
          <div class="hero-grid">
            <div>
              <div class="pill">
                <span class="pill-dot"></span>
                Company prototype – metrics layout only, no live data
              </div>
              <div class="hero-ticker">Apple Inc. · AAPL</div>
              <h1 class="hero-title">Apple metrics overview</h1>
              <p class="hero-subtitle">
                Prototype layout for how a single-company page could look.  
                Ratios on the left, explanations on the right when you click.
              </p>
              <p class="hero-note">
                Values shown here are placeholders. The point is the structure:  
                one place where each metric is clickable and explains itself.
              </p>
            </div>

            <!-- HERO RIGHT: ticker search card -->
            <aside class="search-card">
              <div class="search-label">Ticker search</div>
              <div class="current-ticker-label">
                Currently viewing: <strong>Apple (AAPL)</strong>
              </div>

              <form class="search-row" autocomplete="off" onsubmit="handleSubmit(event)">
                <div class="search-input-wrapper">
                  <input
                    id="searchInput"
                    class="search-input"
                    type="text"
                    name="ticker-input"
                    placeholder="Jump to another ticker (AAPL, TSLA, NVDA...)"
                    oninput="updateSuggestions()"
                    onkeydown="handleKey(event)"
                    autocomplete="off"
                    autocorrect="off"
                    spellcheck="false"
                  />
                  <div id="searchResult" class="suggestion-box" style="display:none;"></div>
                </div>
                <button type="submit" class="search-btn">Go</button>
              </form>

              <div class="tag-row">
                <span class="tag tag--current">AAPL</span>
                <span class="tag" onclick="goToTicker('TSLA')">TSLA</span>
                <span class="tag" onclick="goToTicker('NVDA')">NVDA</span>
                <span class="tag" onclick="goToTicker('AMZN')">AMZN</span>
                <span class="tag" onclick="goToTicker('META')">META</span>
                <span class="tag" onclick="goToTicker('MSFT')">MSFT</span>
              </div>

              <div class="search-callout">
                Use this search to navigate between ticker pages.  
                On each company page, the metrics panel stays the same structure,  
                but the numbers and explanations will eventually be company-specific.
              </div>
            </aside>
          </div>
        </section>

        <!-- METRIC LAYOUT -->
        <section class="section">
          <div class="section-header">
            <h2 class="section-title">Metrics (structure only)</h2>
            <p class="section-subtitle">
              All ratios clickable; descriptions will be filled in later.
            </p>
          </div>

          <div class="metric-layout">
            <!-- LEFT: metric groups -->
            <div class="metric-groups">

              <!-- Financial Strength -->
              <article class="metric-group-card">
                <div class="metric-group-title">Financial Strength</div>
                <div class="metric-group-subtitle">
                  Balance sheet resilience, leverage, and debt servicing capacity.
                </div>
                <table class="metric-table">
                  <thead>
                    <tr>
                      <th>Metric</th>
                      <th>Value</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr>
                      <td><button class="metric-name-btn" data-key="cash-to-debt"><span class="dot"></span>Cash-to-Debt</button></td>
                      <td class="metric-value"><span class="metric-value-pill">TBD</span></td>
                    </tr>
                    <tr>
                      <td><button class="metric-name-btn" data-key="net-debt"><span class="dot"></span>Net Debt</button></td>
                      <td class="metric-value"><span class="metric-value-pill">TBD</span></td>
                    </tr>
                    <tr>
                      <td><button class="metric-name-btn" data-key="equity-to-asset"><span class="dot"></span>Equity-to-Asset</button></td>
                      <td class="metric-value"><span class="metric-value-pill">TBD</span></td>
                    </tr>
                    <tr>
                      <td><button class="metric-name-btn" data-key="debt-to-equity"><span class="dot"></span>Debt-to-Equity</button></td>
                      <td class="metric-value"><span class="metric-value-pill">TBD</span></td>
                    </tr>
                    <tr>
                      <td><button class="metric-name-btn" data-key="debt-to-ebitda"><span class="dot"></span>Debt-to-EBITDA</button></td>
                      <td class="metric-value"><span class="metric-value-pill">TBD</span></td>
                    </tr>
                    <tr>
                      <td><button class="metric-name-btn" data-key="interest-coverage"><span class="dot"></span>Interest Coverage</button></td>
                      <td class="metric-value"><span class="metric-value-pill">TBD</span></td>
                    </tr>
                    <tr>
                      <td><button class="metric-name-btn" data-key="piotroski-f-score"><span class="dot"></span>Piotroski F-Score</button></td>
                      <td class="metric-value"><span class="metric-value-pill">TBD</span></td>
                    </tr>
                    <tr>
                      <td><button class="metric-name-btn" data-key="altman-z-score"><span class="dot"></span>Altman Z-Score</button></td>
                      <td class="metric-value"><span class="metric-value-pill">TBD</span></td>
                    </tr>
                    <tr>
                      <td><button class="metric-name-btn" data-key="beneish-m-score"><span class="dot"></span>Beneish M-Score</button></td>
                      <td class="metric-value"><span class="metric-value-pill">TBD</span></td>
                    </tr>
                    <tr>
                      <td><button class="metric-name-btn" data-key="capex-to-depreciation"><span class="dot"></span>CapEx-to-Depreciation</button></td>
                      <td class="metric-value"><span class="metric-value-pill">TBD</span></td>
                    </tr>
                    <tr>
                      <td><button class="metric-name-btn" data-key="cash-flow-to-debt"><span class="dot"></span>Cash Flow-to-Debt</button></td>
                      <td class="metric-value"><span class="metric-value-pill">TBD</span></td>
                    </tr>
                    <tr>
                      <td><button class="metric-name-btn" data-key="ocf-coverage-ratio"><span class="dot"></span>OCF Coverage Ratio</button></td>
                      <td class="metric-value"><span class="metric-value-pill">TBD</span></td>
                    </tr>
                  </tbody>
                </table>
              </article>

              <!-- Liquidity & Working Capital -->
              <article class="metric-group-card">
                <div class="metric-group-title">Liquidity & Working Capital Efficiency</div>
                <div class="metric-group-subtitle">
                  Short-term solvency and cash conversion through operations.
                </div>
                <table class="metric-table">
                  <thead>
                    <tr>
                      <th>Metric</th>
                      <th>Value</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr>
                      <td><button class="metric-name-btn" data-key="current-ratio"><span class="dot"></span>Current Ratio</button></td>
                      <td class="metric-value"><span class="metric-value-pill">TBD</span></td>
                    </tr>
                    <tr>
                      <td><button class="metric-name-btn" data-key="quick-ratio"><span class="dot"></span>Quick Ratio</button></td>
                      <td class="metric-value"><span class="metric-value-pill">TBD</span></td>
                    </tr>
                    <tr>
                      <td><button class="metric-name-btn" data-key="cash-ratio"><span class="dot"></span>Cash Ratio</button></td>
                      <td class="metric-value"><span class="metric-value-pill">TBD</span></td>
                    </tr>
                    <tr>
                      <td><button class="metric-name-btn" data-key="dso"><span class="dot"></span>Days Sales Outstanding (DSO)</button></td>
                      <td class="metric-value"><span class="metric-value-pill">TBD</span></td>
                    </tr>
                    <tr>
                      <td><button class="metric-name-btn" data-key="dio"><span class="dot"></span>Days Inventory Outstanding (DIO)</button></td>
                      <td class="metric-value"><span class="metric-value-pill">TBD</span></td>
                    </tr>
                    <tr>
                      <td><button class="metric-name-btn" data-key="dpo"><span class="dot"></span>Days Payable Outstanding (DPO)</button></td>
                      <td class="metric-value"><span class="metric-value-pill">TBD</span></td>
                    </tr>
                    <tr>
                      <td><button class="metric-name-btn" data-key="ccc"><span class="dot"></span>Cash Conversion Cycle (CCC)</button></td>
                      <td class="metric-value"><span class="metric-value-pill">TBD</span></td>
                    </tr>
                  </tbody>
                </table>
              </article>

              <!-- Profitability -->
              <article class="metric-group-card">
                <div class="metric-group-title">Profitability</div>
                <div class="metric-group-subtitle">
                  Margins, returns on capital, and earnings quality.
                </div>
                <table class="metric-table">
                  <thead>
                    <tr>
                      <th>Metric</th>
                      <th>Value</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr>
                      <td><button class="metric-name-btn" data-key="gross-margin"><span class="dot"></span>Gross Margin</button></td>
                      <td class="metric-value"><span class="metric-value-pill">TBD</span></td>
                    </tr>
                    <tr>
                      <td><button class="metric-name-btn" data-key="operating-margin"><span class="dot"></span>Operating Margin</button></td>
                      <td class="metric-value"><span class="metric-value-pill">TBD</span></td>
                    </tr>
                    <tr>
                      <td><button class="metric-name-btn" data-key="ebitda-margin"><span class="dot"></span>EBITDA Margin</button></td>
                      <td class="metric-value"><span class="metric-value-pill">TBD</span></td>
                    </tr>
                    <tr>
                      <td><button class="metric-name-btn" data-key="net-margin"><span class="dot"></span>Net Margin</button></td>
                      <td class="metric-value"><span class="metric-value-pill">TBD</span></td>
                    </tr>
                    <tr>
                      <td><button class="metric-name-btn" data-key="fcf-margin"><span class="dot"></span>FCF Margin</button></td>
                      <td class="metric-value"><span class="metric-value-pill">TBD</span></td>
                    </tr>
                    <tr>
                      <td><button class="metric-name-btn" data-key="roe"><span class="dot"></span>Return on Equity (ROE)</button></td>
                      <td class="metric-value"><span class="metric-value-pill">TBD</span></td>
                    </tr>
                    <tr>
                      <td><button class="metric-name-btn" data-key="roa"><span class="dot"></span>Return on Assets (ROA)</button></td>
                      <td class="metric-value"><span class="metric-value-pill">TBD</span></td>
                    </tr>
                    <tr>
                      <td><button class="metric-name-btn" data-key="roce"><span class="dot"></span>Return on Capital Employed (ROCE)</button></td>
                      <td class="metric-value"><span class="metric-value-pill">TBD</span></td>
                    </tr>
                    <tr>
                      <td><button class="metric-name-btn" data-key="roic"><span class="dot"></span>Return on Invested Capital (ROIC)</button></td>
                      <td class="metric-value"><span class="metric-value-pill">TBD</span></td>
                    </tr>
                    <tr>
                      <td><button class="metric-name-btn" data-key="roiic"><span class="dot"></span>ROIIC</button></td>
                      <td class="metric-value"><span class="metric-value-pill">TBD</span></td>
                    </tr>
                    <tr>
                      <td><button class="metric-name-btn" data-key="asset-turnover"><span class="dot"></span>Asset Turnover</button></td>
                      <td class="metric-value"><span class="metric-value-pill">TBD</span></td>
                    </tr>
                    <tr>
                      <td><button class="metric-name-btn" data-key="capital-turnover"><span class="dot"></span>Capital Turnover</button></td>
                      <td class="metric-value"><span class="metric-value-pill">TBD</span></td>
                    </tr>
                    <tr>
                      <td><button class="metric-name-btn" data-key="eps-quality"><span class="dot"></span>EPS Quality</button></td>
                      <td class="metric-value"><span class="metric-value-pill">TBD</span></td>
                    </tr>
                    <tr>
                      <td><button class="metric-name-btn" data-key="years-profitability-10y"><span class="dot"></span>Years of Profitability (10Y)</button></td>
                      <td class="metric-value"><span class="metric-value-pill">TBD</span></td>
                    </tr>
                  </tbody>
                </table>
              </article>

              <!-- Growth -->
              <article class="metric-group-card">
                <div class="metric-group-title">Growth</div>
                <div class="metric-group-subtitle">
                  Medium-term compound growth across key financial lines.
                </div>
                <table class="metric-table">
                  <thead>
                    <tr>
                      <th>Metric</th>
                      <th>Value</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr>
                      <td><button class="metric-name-btn" data-key="rev-cagr-3y"><span class="dot"></span>3Y Revenue CAGR</button></td>
                      <td class="metric-value"><span class="metric-value-pill">TBD</span></td>
                    </tr>
                    <tr>
                      <td><button class="metric-name-btn" data-key="ebitda-cagr-3y"><span class="dot"></span>3Y EBITDA CAGR</button></td>
                      <td class="metric-value"><span class="metric-value-pill">TBD</span></td>
                    </tr>
                    <tr>
                      <td><button class="metric-name-btn" data-key="eps-cagr-3y"><span class="dot"></span>3Y EPS CAGR</button></td>
                      <td class="metric-value"><span class="metric-value-pill">TBD</span></td>
                    </tr>
                    <tr>
                      <td><button class="metric-name-btn" data-key="fcf-cagr-3y"><span class="dot"></span>3Y FCF CAGR</button></td>
                      <td class="metric-value"><span class="metric-value-pill">TBD</span></td>
                    </tr>
                    <tr>
                      <td><button class="metric-name-btn" data-key="book-value-growth-3y"><span class="dot"></span>3Y Book Value Growth</button></td>
                      <td class="metric-value"><span class="metric-value-pill">TBD</span></td>
                    </tr>
                    <tr>
                      <td><button class="metric-name-btn" data-key="dividend-growth-3y"><span class="dot"></span>3Y Dividend Growth</button></td>
                      <td class="metric-value"><span class="metric-value-pill">TBD</span></td>
                    </tr>
                    <tr>
                      <td><button class="metric-name-btn" data-key="tangible-book-growth-3y"><span class="dot"></span>3Y Tangible Book Growth</button></td>
                      <td class="metric-value"><span class="metric-value-pill">TBD</span></td>
                    </tr>
                  </tbody>
                </table>
              </article>

              <!-- Valuation -->
              <article class="metric-group-card">
                <div class="metric-group-title">Valuation</div>
                <div class="metric-group-subtitle">
                  Price multiples on earnings, sales, book value, and cash flows.
                </div>
                <table class="metric-table">
                  <thead>
                    <tr>
                      <th>Metric</th>
                      <th>Value</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr>
                      <td><button class="metric-name-btn" data-key="pe-ratio"><span class="dot"></span>P/E Ratio</button></td>
                      <td class="metric-value"><span class="metric-value-pill">TBD</span></td>
                    </tr>
                    <tr>
                      <td><button class="metric-name-btn" data-key="pe-without-nri"><span class="dot"></span>P/E without NRI</button></td>
                      <td class="metric-value"><span class="metric-value-pill">TBD</span></td>
                    </tr>
                    <tr>
                      <td><button class="metric-name-btn" data-key="price-to-owner-earnings"><span class="dot"></span>Price-to-Owner-Earnings</button></td>
                      <td class="metric-value"><span class="metric-value-pill">TBD</span></td>
                    </tr>
                    <tr>
                      <td><button class="metric-name-btn" data-key="peg-historical"><span class="dot"></span>PEG (historical)</button></td>
                      <td class="metric-value"><span class="metric-value-pill">TBD</span></td>
                    </tr>
                    <tr>
                      <td><button class="metric-name-btn" data-key="price-to-sales"><span class="dot"></span>Price-to-Sales (P/S)</button></td>
                      <td class="metric-value"><span class="metric-value-pill">TBD</span></td>
                    </tr>
                    <tr>
                      <td><button class="metric-name-btn" data-key="price-to-book"><span class="dot"></span>Price-to-Book (P/B)</button></td>
                      <td class="metric-value"><span class="metric-value-pill">TBD</span></td>
                    </tr>
                    <tr>
                      <td><button class="metric-name-btn" data-key="price-to-fcf"><span class="dot"></span>Price-to-Free-Cash-Flow</button></td>
                      <td class="metric-value"><span class="metric-value-pill">TBD</span></td>
                    </tr>
                    <tr>
                      <td><button class="metric-name-btn" data-key="price-to-ocf"><span class="dot"></span>Price-to-Operating-Cash-Flow</button></td>
                      <td class="metric-value"><span class="metric-value-pill">TBD</span></td>
                    </tr>
                  </tbody>
                </table>
              </article>

              <!-- Enterprise Value Multiples / yield set 1 -->
              <article class="metric-group-card">
                <div class="metric-group-title">Enterprise Value / Yield-based (set 1)</div>
                <div class="metric-group-subtitle">
                  Yield-style views on earnings, cash flow, and capital returns.
                </div>
                <table class="metric-table">
                  <thead>
                    <tr>
                      <th>Metric</th>
                      <th>Value</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr>
                      <td><button class="metric-name-btn" data-key="earnings-yield-1"><span class="dot"></span>Earnings Yield</button></td>
                      <td class="metric-value"><span class="metric-value-pill">TBD</span></td>
                    </tr>
                    <tr>
                      <td><button class="metric-name-btn" data-key="fcf-yield-1"><span class="dot"></span>FCF Yield</button></td>
                      <td class="metric-value"><span class="metric-value-pill">TBD</span></td>
                    </tr>
                    <tr>
                      <td><button class="metric-name-btn" data-key="shareholder-yield-1"><span class="dot"></span>Shareholder Yield</button></td>
                      <td class="metric-value"><span class="metric-value-pill">TBD</span></td>
                    </tr>
                    <tr>
                      <td><button class="metric-name-btn" data-key="dividend-yield-1"><span class="dot"></span>Dividend Yield</button></td>
                      <td class="metric-value"><span class="metric-value-pill">TBD</span></td>
                    </tr>
                  </tbody>
                </table>
              </article>

              <!-- Yield-Based (second set) -->
              <article class="metric-group-card">
                <div class="metric-group-title">Yield-Based (set 2)</div>
                <div class="metric-group-subtitle">
                  Same yield concepts, grouped separately if you want a different angle.
                </div>
                <table class="metric-table">
                  <thead>
                    <tr>
                      <th>Metric</th>
                      <th>Value</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr>
                      <td><button class="metric-name-btn" data-key="earnings-yield-2"><span class="dot"></span>Earnings Yield</button></td>
                      <td class="metric-value"><span class="metric-value-pill">TBD</span></td>
                    </tr>
                    <tr>
                      <td><button class="metric-name-btn" data-key="fcf-yield-2"><span class="dot"></span>FCF Yield</button></td>
                      <td class="metric-value"><span class="metric-value-pill">TBD</span></td>
                    </tr>
                    <tr>
                      <td><button class="metric-name-btn" data-key="shareholder-yield-2"><span class="dot"></span>Shareholder Yield</button></td>
                      <td class="metric-value"><span class="metric-value-pill">TBD</span></td>
                    </tr>
                    <tr>
                      <td><button class="metric-name-btn" data-key="dividend-yield-2"><span class="dot"></span>Dividend Yield</button></td>
                      <td class="metric-value"><span class="metric-value-pill">TBD</span></td>
                    </tr>
                  </tbody>
                </table>
              </article>

              <!-- Momentum -->
              <article class="metric-group-card">
                <div class="metric-group-title">Momentum</div>
                <div class="metric-group-subtitle">
                  Price action over short, medium, and longer-term windows.
                </div>
                <table class="metric-table">
                  <thead>
                    <tr>
                      <th>Metric</th>
                      <th>Value</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr>
                      <td><button class="metric-name-btn" data-key="rsi-5d"><span class="dot"></span>5-Day RSI</button></td>
                      <td class="metric-value"><span class="metric-value-pill">TBD</span></td>
                    </tr>
                    <tr>
                      <td><button class="metric-name-btn" data-key="rsi-9d"><span class="dot"></span>9-Day RSI</button></td>
                      <td class="metric-value"><span class="metric-value-pill">TBD</span></td>
                    </tr>
                    <tr>
                      <td><button class="metric-name-btn" data-key="rsi-14d"><span class="dot"></span>14-Day RSI</button></td>
                      <td class="metric-value"><span class="metric-value-pill">TBD</span></td>
                    </tr>
                    <tr>
                      <td><button class="metric-name-btn" data-key="momentum-3-1m"><span class="dot"></span>3–1 Month Momentum %</button></td>
                      <td class="metric-value"><span class="metric-value-pill">TBD</span></td>
                    </tr>
                    <tr>
                      <td><button class="metric-name-btn" data-key="momentum-6-1m"><span class="dot"></span>6–1 Month Momentum %</button></td>
                      <td class="metric-value"><span class="metric-value-pill">TBD</span></td>
                    </tr>
                    <tr>
                      <td><button class="metric-name-btn" data-key="momentum-12-1m"><span class="dot"></span>12–1 Month Momentum %</button></td>
                      <td class="metric-value"><span class="metric-value-pill">TBD</span></td>
                    </tr>
                  </tbody>
                </table>
              </article>
            </div>

           <!-- RIGHT: metric detail panel -->
<aside class="metric-detail-card" id="metricDetailCard">
  <div class="metric-detail-label">Metric detail</div>
  <div class="metric-detail-category" id="metricCategory">Click a metric on the left</div>
  <div class="metric-detail-name" id="metricName">Nothing selected yet</div>

  <div class="metric-detail-body" id="metricDescription">
    When you click on a metric name, this panel will show what it means and how it’s calculated.
    For now the descriptions are placeholders; you’ll plug in the real text later.
  </div>

  <!-- NEW: value row -->
  <div class="metric-detail-value-row">
    <span class="metric-detail-label">Value</span>
    <span class="metric-detail-value" id="metricValue">N/A</span>
  </div>

  <!-- NEW: formula box -->
  <div class="metric-detail-box">
    <div class="metric-detail-label">Formula</div>
    <div class="metric-detail-formula" id="metricFormula">
      Select a metric to see the formula.
    </div>
  </div>

  <!-- NEW: inputs box -->
  <div class="metric-detail-box">
    <div class="metric-detail-label">Inputs</div>
    <div class="metric-detail-inputs" id="metricInputs">
      Inputs will appear here once values are filled in.
    </div>
  </div>

  <div class="metric-detail-hint">
    Idea for later:
    link each explanation directly to highlighted numbers in Apple’s 10-K / 10-Q,
    so users can see exactly which line items feed into the formula.
  </div>
</aside>
          </div>
        </section>
      </div>
    </main>

    <!-- FOOTER -->
    <footer>
      <div class="footer-inner">
        <div>© 2025 Transparent Metrics. All rights reserved.</div>
        <div class="footer-links">
          <a href="./">Home</a>
          <a href="./#about">About</a>
          <a href="./#how-it-works">Concept</a>
        </div>
      </div>
    </footer>
  </div>



  
<script>
// =======================
// Raw data for AAPL (backend layer only)
// Fill these later with real numbers
// =======================

const AAPL_RAW = {
  asOf: "YYYY-MM-DD", // e.g. "2024-09-28"

  // 1. MARKET INPUTS
  market: {
    sharePrice: null,
    sharesOutstanding: null,
    marketCap: null,
    enterpriseValue: null,
    historicalPrices: [
      // { date: "2024-11-01", close: 190.15 },
    ]
  },

  // 2. RAW FINANCIAL INPUTS
  statements: {
    incomeStatement: {
      revenue: null,
      cogs: null,
      grossProfit: null,
      operatingExpenses: null,
      depreciationAmort: null, // placeholder
      operatingIncomeEBIT: null,
      ebitda: null,
      interestExpense: null,
      pretaxIncome: null,
      netIncome: null,
      netIncomeExNRI: null
    },
    balanceSheet: {
      totalAssets: null,
      totalCurrentAssets: null,
      cashAndEquivalents: null,
      accountsReceivable: null,
      inventory: null,
      otherCurrentAssets: null,
      totalLiabilities: null,
      currentLiabilities: null,
      accountsPayable: null,
      longTermDebt: null,
      shortTermDebt: null,
      shareholdersEquity: null,
      investedCapital: null
    },
    cashFlow: {
      operatingCashFlow: null,
      freeCashFlow: null,
      capitalExpenditures: null,
      ownerEarnings: null,
      dividendsPaid: null,
      cashFlowFromFinancing: null,
      taxRate: null
    }
  },

  // 3. OPTIONAL INPUTS
  optional: {
    quality: {
      retainedEarnings: null,
      workingCapital: null,
      tenYearProfitHistory: [],
      segmentRevenue: []
    },
    multiYearFinancials: {
      revenue: [],
      ebitda: [],
      netIncome: [],
      freeCashFlow: [],
      bookValue: []
    },
    financingDetail: {
      shareRepurchases: null,
      shareIssuances: null
    }
  }
};

window.AAPL_RAW = AAPL_RAW;

// =======================
// Helpers
// =======================

function formatValue(val, { pct = false, decimals = 2, suffix = "" } = {}) {
  if (val == null || Number.isNaN(val)) return "N/A";
  const num = pct ? val * 100 : val;
  return num.toFixed(decimals) + (pct ? "%" : suffix);
}

function safeSum(...vals) {
  return vals.reduce((acc, v) => acc + (v ?? 0), 0);
}

// =======================
// Ticker navigation / search
// =======================

const STOCKS = {
  AAPL: "Apple Inc.",
  TSLA: "Tesla Inc.",
  NVDA: "NVIDIA Corp.",
  AMZN: "Amazon.com Inc.",
  MSFT: "Microsoft Corp.",
  META: "Meta Platforms Inc.",
  GOOGL: "Alphabet Class A"
};

function goToTicker(ticker) {
  if (!ticker) return;
  const upper = ticker.toUpperCase();
  window.location.href = `${upper}.html`;
}

function updateSuggestions() {
  const input = document.getElementById("searchInput").value.trim().toUpperCase();
  const resultBox = document.getElementById("searchResult");

  if (input === "") {
    resultBox.style.display = "none";
    resultBox.innerHTML = "";
    return;
  }

  const matches = Object.keys(STOCKS).filter(ticker =>
    ticker.startsWith(input)
  );

  if (matches.length === 0) {
    resultBox.style.display = "block";
    resultBox.innerHTML = `
      <span style="color: #f87171; font-weight:600;">No matches for "${input}"</span>
    `;
    return;
  }

  const list = matches
    .map(
      ticker => `
        <li>
          <a href="${ticker}.html" class="suggestion-link">
            <span class="suggestion-ticker">${ticker}</span>
            <span class="suggestion-name">— ${STOCKS[ticker]}</span>
          </a>
        </li>
      `
    )
    .join("");

  resultBox.style.display = "block";
  resultBox.innerHTML = `<ul>${list}</ul>`;
}

function handleKey(event) {
  if (event.key !== "Enter") return;
  event.preventDefault();

  const inputEl = document.getElementById("searchInput");
  const value = inputEl.value.trim().toUpperCase();
  const resultBox = document.getElementById("searchResult");

  if (!value) return;

  if (STOCKS[value]) {
    resultBox.style.display = "none";
    goToTicker(value);
    return;
  }

  const matches = Object.keys(STOCKS).filter(ticker =>
    ticker.startsWith(value)
  );

  if (matches.length > 0) {
    const best = matches[0];
    resultBox.style.display = "none";
    goToTicker(best);
    return;
  }

  resultBox.style.display = "block";
  resultBox.innerHTML = `
    <span style="color: #f87171; font-weight:600;">
      No matches for "${value}"
    </span>
  `;
}

function handleSubmit(event) {
  event.preventDefault();
  handleKey({ key: "Enter", preventDefault: () => {} });
}

// =======================
// Metric info + formulas
// =======================

const METRIC_INFO = {
  // --- Financial Strength ---
  "cash-to-debt": {
    category: "Financial Strength",
    name: "Cash-to-Debt",
    description: "Cash and equivalents divided by total debt. Higher = more cushion to cover debt with cash.",
    formula: "Cash & cash equivalents ÷ (Short-term debt + Long-term debt)",
    compute: raw => {
      const bs = raw.statements.balanceSheet;
      const cash = bs.cashAndEquivalents;
      const debt = safeSum(bs.shortTermDebt, bs.longTermDebt);
      const value = debt === 0 || cash == null ? null : cash / debt;
      return {
        value,
        display: formatValue(value),
        inputs: [
          `Cash & equivalents: ${cash ?? "N/A"}`,
          `Short-term debt: ${bs.shortTermDebt ?? "N/A"}`,
          `Long-term debt: ${bs.longTermDebt ?? "N/A"}`
        ]
      };
    }
  },
  "net-debt": {
    category: "Financial Strength",
    name: "Net Debt",
    description: "Total debt minus cash. Negative means net cash position.",
    formula: "(Short-term debt + Long-term debt) – Cash & cash equivalents",
    compute: raw => {
      const bs = raw.statements.balanceSheet;
      const debt = safeSum(bs.shortTermDebt, bs.longTermDebt);
      const cash = bs.cashAndEquivalents ?? 0;
      const value = debt - cash;
      return {
        value,
        display: value == null ? "N/A" : value.toLocaleString(),
        inputs: [
          `Total debt: ${debt ?? "N/A"}`,
          `Cash & equivalents: ${bs.cashAndEquivalents ?? "N/A"}`
        ]
      };
    }
  },
  "equity-to-asset": {
    category: "Financial Strength",
    name: "Equity-to-Asset",
    description: "Shareholders’ equity relative to total assets. Higher = lower balance sheet leverage.",
    formula: "Shareholders’ equity ÷ Total assets",
    compute: raw => {
      const bs = raw.statements.balanceSheet;
      const eq = bs.shareholdersEquity;
      const assets = bs.totalAssets;
      const value = assets ? eq / assets : null;
      return {
        value,
        display: formatValue(value, { pct: true }),
        inputs: [
          `Shareholders’ equity: ${eq ?? "N/A"}`,
          `Total assets: ${assets ?? "N/A"}`
        ]
      };
    }
  },
  "debt-to-equity": {
    category: "Financial Strength",
    name: "Debt-to-Equity",
    description: "Total debt compared to shareholders’ equity. Higher = more leverage.",
    formula: "(Short-term debt + Long-term debt) ÷ Shareholders’ equity",
    compute: raw => {
      const bs = raw.statements.balanceSheet;
      const debt = safeSum(bs.shortTermDebt, bs.longTermDebt);
      const eq = bs.shareholdersEquity;
      const value = eq ? debt / eq : null;
      return {
        value,
        display: formatValue(value),
        inputs: [
          `Total debt: ${debt ?? "N/A"}`,
          `Shareholders’ equity: ${eq ?? "N/A"}`
        ]
      };
    }
  },
  "debt-to-ebitda": {
    category: "Financial Strength",
    name: "Debt-to-EBITDA",
    description: "Total debt divided by EBITDA. Rough pay-down years in a no-growth world.",
    formula: "(Short-term debt + Long-term debt) ÷ EBITDA"
  },
  "interest-coverage": {
    category: "Financial Strength",
    name: "Interest Coverage",
    description: "EBIT divided by interest expense. How many times operating income covers interest.",
    formula: "EBIT ÷ Interest expense"
  },
  "piotroski-f-score": {
    category: "Financial Strength",
    name: "Piotroski F-Score",
    description: "0–9 composite score across profitability, leverage, liquidity, and operating efficiency.",
    formula: "Sum of 9 binary signals (ROA, CFO, margin, leverage, etc.)"
  },
  "altman-z-score": {
    category: "Financial Strength",
    name: "Altman Z-Score",
    description: "Statistical bankruptcy risk model. Higher = safer balance sheet.",
    formula: "Z = 1.2·(WC/TA) + 1.4·(RE/TA) + 3.3·(EBIT/TA) + 0.6·(MVE/TL) + 1.0·(Sales/TA)"
  },
  "beneish-m-score": {
    category: "Financial Strength",
    name: "Beneish M-Score",
    description: "Model to flag potential earnings manipulation using 8 accounting ratios.",
    formula: "M = −4.84 + 0.92·DSRI + 0.53·GMI + 0.404·AQI + 0.892·SGI + 0.115·DEPI – 0.172·SGAI + 4.679·ACCR – 0.327·LEVI"
  },
  "capex-to-depreciation": {
    category: "Financial Strength",
    name: "CapEx-to-Depreciation",
    description: "Signals reinvestment intensity vs current asset base.",
    formula: "Capital expenditures ÷ Depreciation & amortization"
  },
  "cash-flow-to-debt": {
    category: "Financial Strength",
    name: "Cash Flow-to-Debt",
    description: "Operating cash flow relative to total debt.",
    formula: "Operating cash flow ÷ (Short-term debt + Long-term debt)"
  },
  "ocf-coverage-ratio": {
    category: "Financial Strength",
    name: "OCF Coverage Ratio",
    description: "Operating cash flow divided by interest expense.",
    formula: "Operating cash flow ÷ Interest expense"
  },

  // --- Liquidity & Working Capital Efficiency ---
  "current-ratio": {
    category: "Liquidity & Working Capital Efficiency",
    name: "Current Ratio",
    description: "Current assets divided by current liabilities.",
    formula: "Current assets ÷ Current liabilities",
    compute: raw => {
      const bs = raw.statements.balanceSheet;
      const ca = bs.totalCurrentAssets;
      const cl = bs.currentLiabilities;
      const value = cl ? ca / cl : null;
      return {
        value,
        display: formatValue(value),
        inputs: [
          `Current assets: ${ca ?? "N/A"}`,
          `Current liabilities: ${cl ?? "N/A"}`
        ]
      };
    }
  },
  "quick-ratio": {
    category: "Liquidity & Working Capital Efficiency",
    name: "Quick Ratio",
    description: "Stricter liquidity: (CA – inventory) divided by CL.",
    formula: "(Current assets – Inventory) ÷ Current liabilities",
    compute: raw => {
      const bs = raw.statements.balanceSheet;
      const ca = bs.totalCurrentAssets;
      const inv = bs.inventory ?? 0;
      const cl = bs.currentLiabilities;
      const quickAssets = ca == null ? null : ca - inv;
      const value = cl && quickAssets != null ? quickAssets / cl : null;
      return {
        value,
        display: formatValue(value),
        inputs: [
          `Current assets: ${ca ?? "N/A"}`,
          `Inventory: ${bs.inventory ?? "N/A"}`,
          `Current liabilities: ${cl ?? "N/A"}`
        ]
      };
    }
  },
  "cash-ratio": {
    category: "Liquidity & Working Capital Efficiency",
    name: "Cash Ratio",
    description: "Cash divided by current liabilities.",
    formula: "Cash & cash equivalents ÷ Current liabilities"
  },
  "dso": {
    category: "Liquidity & Working Capital Efficiency",
    name: "Days Sales Outstanding (DSO)",
    description: "Average collection period for receivables.",
    formula: "(Accounts receivable ÷ Revenue) × 365"
  },
  "dio": {
    category: "Liquidity & Working Capital Efficiency",
    name: "Days Inventory Outstanding (DIO)",
    description: "Average days inventory is held.",
    formula: "(Inventory ÷ COGS) × 365"
  },
  "dpo": {
    category: "Liquidity & Working Capital Efficiency",
    name: "Days Payable Outstanding (DPO)",
    description: "Average days to pay suppliers.",
    formula: "(Accounts payable ÷ COGS) × 365"
  },
  "ccc": {
    category: "Liquidity & Working Capital Efficiency",
    name: "Cash Conversion Cycle (CCC)",
    description: "Working capital cycle in days.",
    formula: "DSO + DIO – DPO"
  },

  // --- Profitability ---
  "gross-margin": {
    category: "Profitability",
    name: "Gross Margin",
    description: "Gross profit as a percentage of revenue.",
    formula: "(Revenue – COGS) ÷ Revenue",
    compute: raw => {
      const is = raw.statements.incomeStatement;
      const rev = is.revenue;
      const cogs = is.cogs;
      const gp = rev != null && cogs != null ? rev - cogs : null;
      const value = rev ? gp / rev : null;
      return {
        value,
        display: formatValue(value, { pct: true }),
        inputs: [
          `Revenue: ${rev ?? "N/A"}`,
          `COGS: ${cogs ?? "N/A"}`,
          `Gross profit: ${gp ?? "N/A"}`
        ]
      };
    }
  },
  "operating-margin": {
    category: "Profitability",
    name: "Operating Margin",
    description: "EBIT as a percentage of revenue.",
    formula: "EBIT ÷ Revenue",
    compute: raw => {
      const is = raw.statements.incomeStatement;
      const rev = is.revenue;
      const ebit = is.operatingIncomeEBIT;
      const value = rev ? ebit / rev : null;
      return {
        value,
        display: formatValue(value, { pct: true }),
        inputs: [
          `Revenue: ${rev ?? "N/A"}`,
          `EBIT: ${ebit ?? "N/A"}`
        ]
      };
    }
  },
  "ebitda-margin": {
    category: "Profitability",
    name: "EBITDA Margin",
    description: "EBITDA as a percentage of revenue.",
    formula: "EBITDA ÷ Revenue"
  },
  "net-margin": {
    category: "Profitability",
    name: "Net Margin",
    description: "Net income as a percentage of revenue.",
    formula: "Net income ÷ Revenue",
    compute: raw => {
      const is = raw.statements.incomeStatement;
      const rev = is.revenue;
      const ni = is.netIncome;
      const value = rev ? ni / rev : null;
      return {
        value,
        display: formatValue(value, { pct: true }),
        inputs: [
          `Revenue: ${rev ?? "N/A"}`,
          `Net income: ${ni ?? "N/A"}`
        ]
      };
    }
  },
  "fcf-margin": {
    category: "Profitability",
    name: "FCF Margin",
    description: "Free cash flow as a percentage of revenue.",
    formula: "Free cash flow ÷ Revenue"
  },
  "roe": {
    category: "Profitability",
    name: "Return on Equity (ROE)",
    description: "Net income divided by shareholders’ equity.",
    formula: "Net income ÷ Shareholders’ equity"
  },
  "roa": {
    category: "Profitability",
    name: "Return on Assets (ROA)",
    description: "Net income divided by total assets.",
    formula: "Net income ÷ Total assets"
  },
  "roce": {
    category: "Profitability",
    name: "Return on Capital Employed (ROCE)",
    description: "EBIT divided by capital employed.",
    formula: "EBIT ÷ (Total assets – Current liabilities)"
  },
  "roic": {
    category: "Profitability",
    name: "Return on Invested Capital (ROIC)",
    description: "NOPAT divided by invested capital.",
    formula: "NOPAT ÷ Invested capital"
  },
  "roiic": {
    category: "Profitability",
    name: "ROIIC",
    description: "Return on newly invested capital.",
    formula: "Δ NOPAT ÷ Δ Invested capital"
  },
  "asset-turnover": {
    category: "Profitability",
    name: "Asset Turnover",
    description: "Revenue relative to total assets.",
    formula: "Revenue ÷ Total assets"
  },
  "capital-turnover": {
    category: "Profitability",
    name: "Capital Turnover",
    description: "Revenue relative to invested capital.",
    formula: "Revenue ÷ Invested capital"
  },
  "eps-quality": {
    category: "Profitability",
    name: "EPS Quality",
    description: "How much earnings are backed by operating cash flow.",
    formula: "Operating cash flow ÷ Net income"
  },
  "years-profitability-10y": {
    category: "Profitability",
    name: "Years of Profitability (10Y)",
    description: "Number of profitable years in the last 10.",
    formula: "Count of years in last 10 with net income > 0"
  },

  // --- Growth ---
  "rev-cagr-3y": {
    category: "Growth",
    name: "3Y Revenue CAGR",
    description: "Compound annual growth in revenue over 3 years.",
    formula: "CAGR = (Revenueₜ / Revenueₜ₋₃)^(1/3) − 1"
  },
  "ebitda-cagr-3y": {
    category: "Growth",
    name: "3Y EBITDA CAGR",
    description: "Compound annual growth in EBITDA over 3 years.",
    formula: "CAGR = (EBITDAₜ / EBITDAₜ₋₃)^(1/3) − 1"
  },
  "eps-cagr-3y": {
    category: "Growth",
    name: "3Y EPS CAGR",
    description: "Compound annual growth in EPS over 3 years.",
    formula: "CAGR = (EPSₜ / EPSₜ₋₃)^(1/3) − 1"
  },
  "fcf-cagr-3y": {
    category: "Growth",
    name: "3Y FCF CAGR",
    description: "Compound annual growth in free cash flow over 3 years.",
    formula: "CAGR = (FCFₜ / FCFₜ₋₃)^(1/3) − 1"
  },
  "book-value-growth-3y": {
    category: "Growth",
    name: "3Y Book Value Growth",
    description: "Compound annual growth in book value over 3 years.",
    formula: "CAGR = (Book valueₜ / Book valueₜ₋₃)^(1/3) − 1"
  },
  "dividend-growth-3y": {
    category: "Growth",
    name: "3Y Dividend Growth",
    description: "Compound annual growth in dividends per share.",
    formula: "CAGR = (Dividendₜ / Dividendₜ₋₃)^(1/3) − 1"
  },
  "tangible-book-growth-3y": {
    category: "Growth",
    name: "3Y Tangible Book Growth",
    description: "Compound growth in tangible book value.",
    formula: "CAGR on tangible book value"
  },

  // --- Valuation ---
  "pe-ratio": {
    category: "Valuation",
    name: "P/E Ratio",
    description: "Price divided by trailing twelve-month earnings per share.",
    formula: "Share price ÷ EPS (ttm)",
    compute: raw => {
      const price = raw.market.sharePrice;
      const is = raw.statements.incomeStatement;
      const shares = raw.market.sharesOutstanding;
      const ni = is.netIncome;
      if (!price || !shares || !ni) {
        return {
          value: null,
          display: "N/A",
          inputs: [
            `Share price: ${price ?? "N/A"}`,
            `Net income (ttm): ${ni ?? "N/A"}`,
            `Shares outstanding: ${shares ?? "N/A"}`
          ]
        };
      }
      const eps = ni / shares;
      const pe = price / eps;
      return {
        value: pe,
        display: formatValue(pe),
        inputs: [
          `Share price: ${price}`,
          `Net income (ttm): ${ni}`,
          `Shares outstanding: ${shares}`,
          `EPS (ttm) = ${eps.toFixed(2)}`
        ]
      };
    }
  },
  "pe-without-nri": {
    category: "Valuation",
    name: "P/E without NRI",
    description: "Price divided by EPS excluding non-recurring items.",
    formula: "Share price ÷ EPS (excluding NRI)"
  },
  "price-to-owner-earnings": {
    category: "Valuation",
    name: "Price-to-Owner-Earnings",
    description: "Price relative to owner earnings (Buffett-style earnings).",
    formula: "Market cap ÷ Owner earnings"
  },
  "peg-historical": {
    category: "Valuation",
    name: "PEG (historical)",
    description: "P/E divided by historical EPS CAGR.",
    formula: "P/E ÷ EPS CAGR"
  },
  "price-to-sales": {
    category: "Valuation",
    name: "Price-to-Sales (P/S)",
    description: "Market cap relative to revenue.",
    formula: "Market cap ÷ Revenue",
    compute: raw => {
      const mc = raw.market.marketCap;
      const rev = raw.statements.incomeStatement.revenue;
      const value = mc && rev ? mc / rev : null;
      return {
        value,
        display: formatValue(value),
        inputs: [
          `Market cap: ${mc ?? "N/A"}`,
          `Revenue: ${rev ?? "N/A"}`
        ]
      };
    }
  },
  "price-to-book": {
    category: "Valuation",
    name: "Price-to-Book (P/B)",
    description: "Market cap relative to book value of equity.",
    formula: "Market cap ÷ Shareholders’ equity"
  },
  "price-to-fcf": {
    category: "Valuation",
    name: "Price-to-Free-Cash-Flow",
    description: "Market cap relative to free cash flow.",
    formula: "Market cap ÷ Free cash flow",
    compute: raw => {
      const mc = raw.market.marketCap;
      const fcf = raw.statements.cashFlow.freeCashFlow;
      const value = mc && fcf ? mc / fcf : null;
      return {
        value,
        display: formatValue(value),
        inputs: [
          `Market cap: ${mc ?? "N/A"}`,
          `Free cash flow: ${fcf ?? "N/A"}`
        ]
      };
    }
  },
  "price-to-ocf": {
    category: "Valuation",
    name: "Price-to-Operating-Cash-Flow",
    description: "Market cap relative to operating cash flow.",
    formula: "Market cap ÷ Operating cash flow"
  },

  // --- Enterprise Value Multiples / Yield-Based ---
  "earnings-yield-1": {
    category: "Enterprise Value Multiples",
    name: "Earnings Yield",
    description: "Inverse of P/E.",
    formula: "1 ÷ P/E"
  },
  "fcf-yield-1": {
    category: "Enterprise Value Multiples",
    name: "FCF Yield",
    description: "Free cash flow divided by market cap.",
    formula: "Free cash flow ÷ Market cap"
  },
  "shareholder-yield-1": {
    category: "Enterprise Value Multiples",
    name: "Shareholder Yield",
    description: "Dividends, buybacks and net debt paydown as a yield.",
    formula: "(Dividends + Buybacks + Net debt paydown) ÷ Market cap"
  },
  "dividend-yield-1": {
    category: "Enterprise Value Multiples",
    name: "Dividend Yield",
    description: "Dividends per share divided by share price.",
    formula: "Dividend per share ÷ Share price"
  },

  "earnings-yield-2": {
    category: "Yield-Based",
    name: "Earnings Yield",
    description: "Same as above, shown in a yield grouping.",
    formula: "1 ÷ P/E"
  },
  "fcf-yield-2": {
    category: "Yield-Based",
    name: "FCF Yield",
    description: "Same as above, shown in a yield grouping.",
    formula: "Free cash flow ÷ Market cap"
  },
  "shareholder-yield-2": {
    category: "Yield-Based",
    name: "Shareholder Yield",
    description: "Same as above, shown in a yield grouping.",
    formula: "(Dividends + Buybacks + Net debt paydown) ÷ Market cap"
  },
  "dividend-yield-2": {
    category: "Yield-Based",
    name: "Dividend Yield",
    description: "Same as above, shown in a yield grouping.",
    formula: "Dividend per share ÷ Share price"
  },

  // --- Momentum ---
  "rsi-5d": {
    category: "Momentum",
    name: "5-Day RSI",
    description: "Relative Strength Index over 5 trading days.",
    formula: "Standard RSI formula over 5 periods using closing prices"
  },
  "rsi-9d": {
    category: "Momentum",
    name: "9-Day RSI",
    description: "Relative Strength Index over 9 trading days.",
    formula: "Standard RSI formula over 9 periods using closing prices"
  },
  "rsi-14d": {
    category: "Momentum",
    name: "14-Day RSI",
    description: "Relative Strength Index over 14 trading days.",
    formula: "Standard RSI formula over 14 periods using closing prices"
  },
  "momentum-3-1m": {
    category: "Momentum",
    name: "3–1 Month Momentum %",
    description: "Price momentum between 3 months ago and 1 month ago.",
    formula: "(Price at T−1m ÷ Price at T−3m) − 1"
  },
  "momentum-6-1m": {
    category: "Momentum",
    name: "6–1 Month Momentum %",
    description: "Momentum between 6 months ago and 1 month ago.",
    formula: "(Price at T−1m ÷ Price at T−6m) − 1"
  },
  "momentum-12-1m": {
    category: "Momentum",
    name: "12–1 Month Momentum %",
    description: "Momentum between 12 months ago and 1 month ago.",
    formula: "(Price at T−1m ÷ Price at T−12m) − 1"
  }
};

// =======================
// Metric panel wiring
// =======================

const categoryEl = document.getElementById("metricCategory");
const nameEl = document.getElementById("metricName");
const descEl = document.getElementById("metricDescription");
const valueEl = document.getElementById("metricValue");
const formulaEl = document.getElementById("metricFormula");
const inputsEl = document.getElementById("metricInputs");

function setActiveButton(clickedBtn) {
  document.querySelectorAll(".metric-name-btn").forEach(btn => {
    btn.classList.remove("active");
  });
  if (clickedBtn) {
    clickedBtn.classList.add("active");
  }
}

function showMetricInfo(key, btn) {
  const info = METRIC_INFO[key];
  if (!info) return;

  setActiveButton(btn);
  categoryEl.textContent = info.category;
  nameEl.textContent = info.name;
  descEl.textContent = info.description || "";

  let valueText = "N/A";
  let formulaText = info.formula || "–";
  let inputsHtml = "";

  if (info.compute) {
    const res = info.compute(window.AAPL_RAW || {});
    if (res) {
      if (res.display) {
        valueText = res.display;
      } else if (res.value != null) {
        valueText = String(res.value);
      }
      if (res.inputs) {
        inputsHtml = Array.isArray(res.inputs)
          ? res.inputs.map(line => `<div>${line}</div>`).join("")
          : res.inputs;
      }
    }
  }

  // Update the detail panel
  valueEl.textContent = valueText;
  formulaEl.textContent = formulaText;
  inputsEl.innerHTML = inputsHtml || "Inputs will appear here once values are filled in.";

  // Update the pill in the left-hand table row
  if (btn) {
    const row = btn.closest("tr");
    if (row) {
      const pill = row.querySelector(".metric-value-pill");
      if (pill) {
        pill.textContent = valueText;
      }
    }
  }
}

// Attach click handlers
document.querySelectorAll(".metric-name-btn").forEach(btn => {
  btn.addEventListener("click", () => {
    const key = btn.getAttribute("data-key");
    showMetricInfo(key, btn);
  });
});

// Default selection: P/E
const defaultBtn = document.querySelector('.metric-name-btn[data-key="pe-ratio"]');
if (defaultBtn) {
  showMetricInfo("pe-ratio", defaultBtn);
}
</script>
</body>
</html>
